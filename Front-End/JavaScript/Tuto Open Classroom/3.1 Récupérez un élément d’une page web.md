
Dans la partie précédente, nous avons découvert la logique de programmation en JavaScript, et nous avons manipulé des structures conditionnelles, des boucles et des fonctions. Nous avons fait une belle partie du chemin, mais pour l’instant, nous nous sommes contentés d’écrire dans la console. Notre prochaine étape est donc de **manipuler directement une page HTML** **pour la rendre interactive**. Dans le cadre de notre application Azertype, cela permettra d’afficher en HTML les mots à recopier et le score.

Pour appréhender cette étape, vous devez donc maîtriser les fondamentaux du langage HTML. Si ce n’est pas le cas, je vous conseille fortement de suivre le cours _[Créez votre site web avec HTML 5 et CSS 3](https://openclassrooms.com/fr/courses/1603881-creez-votre-site-web-avec-html5-et-css3)_.

Notre première étape, dans ce chapitre, est d’**établir un lien entre le code HTML et le code JavaScript**. Cela nous permettra, dans le chapitre suivant, de modifier le code HTML directement depuis notre code JavaScript. Alors, avant de rentrer dans le vif du sujet, regardons ensemble comment une page web est structurée ! 😉

# Appréhendez la structure d’une page web

Généralement, une page web est constituée de deux parties :

- un _**head**_ qui donne des informations générales sur la page ;
- un _**body**_ qui contient ce qui est affiché dans la page. 

> Voici un exemple de body pour une page simple :

```
<body>
    <header>
        <h1>AzerType</h1>
    </header>
    <main>
        <div>
            <h2>Le jeu</h2>
            <p>Un petit texte</p>
        </div>
        <div>
            <h2>Une autre div</h2>
            <p>Un autre texte</p>
        </div>
    </main>
    <footer>
        @Copyright : OpenClassrooms.
    </footer>
</body>
```

Ce code HTML est simple. Il est constitué d’un _header_ avec un titre, d’un corps (_main_) et d’un _footer_.

Ce code est un peu structuré comme un arbre, c’est pourquoi on appelle cette structure l’**arbre DOM** (Document Object Model, ou modèle objet du document, en français). En fait, JavaScript ne lit pas une page HTML comme du simple texte. Il la représente comme une structure organisée en parents/enfants, et composée de nœuds qui représentent des balises.

*Ouh là là là, ça devient un peu abstrait ton truc, là… 😅*

C’est un peu imagé oui, mais revenons ensemble sur l’illustration de l’arbre DOM ci-dessous :

[![Structure de l'arbre DOM. En haut la racine de l’arbre DOM. Au milieu les branches, qui mènent à des nœuds : header, main, footer, h1, h2... et à une feuille : texte.](https://user.oc-static.com/upload/2023/05/09/16836136690232_STATIC-P3C1.png)](https://user.oc-static.com/upload/2023/05/09/16836136690232_STATIC-P3C1.png)

Dans la structure ci-dessus :

- le _body_ en haut représente la racine de l’arbre DOM ;
- de cette racine se déploient des **branches** (en bleu sur l’image) ;
- ces branches mènent à des **nœuds** : _header_, _main, footer, h1, h2, div, p…_ ;
- les branches se terminent généralement par une **feuille** : _texte_. 

En développement informatique, on dit que _header, main et footer_ sont les noeuds **enfants** de _body_, et que _body_ est le **parent** de ces nœuds.

Chaque nœud de cet arbre DOM (_header_, _main_, _div_…) est un **objet HTMLElement**. Pour le dire autrement, JavaScript a regroupé dans un même objet deux choses : 

- les informations sur cet objet (son nom, son id, sa position, etc.) : ce sont les **propriétés** de l’objet ;
- ce que cet objet est capable de faire (réagir au clic, par exemple) : ce sont les **méthodes**. 

Dans ce cours, nous explorons plusieurs propriétés et méthodes, mais il en existe d’autres. Si vous voulez en savoir plus, la [documentation](https://developer.mozilla.org/fr/docs/Web/API/HTMLElement) est à votre disposition. 😃

# Récupérez un élément du DOM

Dans ce chapitre, notre but est de récupérer certains éléments de l’arbre DOM, qui a pour racine la balise _body_. Cependant, vous vous souvenez peut-être que nos fichiers JavaScript sont stockés dans la balise _head,_ qui se situe **avant** le _body_.

## Utilisez defer pour différer l’exécution du script

Pour manipuler le DOM, JavaScript doit ainsi construire une variable globale, _**document**_, qui est donc accessible depuis n’importe où dans notre code. Cependant, pour construire cette variable, la page HTML doit être chargée en entier. Or, le script étant lancé dans la balise head, avant que le body ne s’affiche à l’écran, la page HTML n’existe pas encore. Nous devons donc attendre que la page ait fini de charger avant d’utiliser la variable _document._

Pour résoudre ce problème, la méthode la plus efficace est d’**ajouter le mot-clé** _**defer**_ **dans la balise script**. Concrètement, cela revient à demander au navigateur “Si tu rencontres la balise script, **diffère** sa prise en compte et attends que la page soit chargée.”

```
<script src="scripts/config.js" defer></script>
<script src="scripts/script.js" defer></script>
<script src="scripts/main.js" defer></script>
```

## Utilisez différentes syntaxes pour récupérer un élément

JavaScript propose tout un éventail de méthodes pour récupérer les éléments du DOM. Dans ce chapitre, nous en aborderons trois :

- getElementById ;
- querySelector ;
- querySelectorAll.

Il existe bien sûr d’autres méthodes, et je vous invite d’ailleurs à les découvrir par vous-même. L’essentiel est de **choisir la méthode la plus adaptée à la problématique** suivante : cibler le ou les éléments qui nous intéressent au milieu d’une page HTML souvent très conséquente. 

### Récupérez un élément avec _getElementById_

La première méthode, et probablement la plus simple, est getElementById. Comme son nom l’indique, elle permet de récupérer un élément en fournissant son id en paramètre.

> Dans notre application par exemple, nous affichions jusqu’à maintenant le mot à recopier dans le texte du _prompt_. Désormais, notre objectif est de l’afficher dans une zone de la page dédiée.

Pour cela, nous pouvons commencer par créer une _div_ dans le HTML. Pour la distinguer des autres, nous lui fournissons un id :

```
<body>
    <div id="zoneProposition">Cachalot</div>
</body>
```

Pour accéder à cette balise, nous allons donc écrire :

```
let baliseZoneProposition = document.getElementById("zoneProposition");
console.log(baliseZoneProposition);
```

Ici, nous avons demandé à JavaScript, depuis _document_, donc toute la page : “Trouve-moi un élément HTML qui a pour id _zoneProposition”_. Puis nous avons mis le résultat dans la variable _baliseZoneProposition_. 

Quand nous faisons un console.log de cette variable, nous constatons bien le contenu de notre variable _baliseZoneProposition_, et nous retrouvons bien notre div :

[![À gauche de la capture d'écran : un petit triangle à côté d'une div.](https://user.oc-static.com/upload/2023/04/12/16813147039516_image20.png)](https://user.oc-static.com/upload/2023/04/12/16813147039516_image20.png)

Cette variable est un objet de type _HTMLElement_. Si nous cliquons sur le petit triangle à côté de cette div pour déployer le contenu, les détails de cet objet HTMLElement vont s’afficher, comme dans la capture d’écran ci-dessous.

[![Les détails de la div id= sont affichées sur la capture d'écran (20 lignes).](https://user.oc-static.com/upload/2023/04/12/168131474106_image4.png)](https://user.oc-static.com/upload/2023/04/12/168131474106_image4.png)

Détail d’un objet HTMLElement

*Ah oui…. Ca fait beaucoup d'informations, tout ça !*

Eh oui… JavaScript propose beaucoup de propriétés et de méthodes sur les objets HTLMElement. Pour vous, ce sont autant d’opportunités d’aller les piocher en fonction de vos besoins !

Enfin, comme pour n’importe quel objet en JavaScript, vous pouvez accéder aux propriétés de votre nœud grâce au point “**.**” .

> Par exemple, pour afficher la hauteur de l’élément dans votre console, vous pouvez écrire :

```
console.log(baliseZoneProposition.clientHeight);
```

### Récupérez un élément QuerySelector

Lorsqu’on a un id sur nos éléments, document.getElementById est une bonne option pour les récupérer. Malheureusement, il arrive régulièrement que ça ne soit pas le cas !

JavaScript a donné une réponse particulièrement intuitive à ce problème : utiliser les sélecteurs CSS. En gros, si vous savez désigner un élément en CSS, alors il vous suffit de reprendre exactement la même syntaxe ! 😃

> Modifions légèrement le contenu de notre page HTML pour illustrer cela :

```
<body>
    <div id="zoneProposition">
        Entrez le mot : <span>Cachalot</span>
    </div>
</body>
```

Pour mettre le mot _Cachalot_ en gras en CSS, nous aurions écrit :

```
#zoneProposition span {
    font-weight: bold;
}
```

Ce code signifie : “Il faut mettre la police d’écriture en **gras** pour tous les _span_ contenus dans un élément qui a l’id _zoneProposition_.”

querySelector nous permet de trouver le premier élément qui correspond au sélecteur CSS proposé :

```
let baliseZonePropositionSpan = document.querySelector("#zoneProposition span");
console.log(baliseZonePropositionSpan);
```

Et voilà le résultat dans la capture d’écran ci-dessous : nous voyons dans la console que nous avons bien trouvé notre span.

[![Capture d'écran. Sous l'onglet Console,  s'affiche à droite d'un petit triangle.](https://user.oc-static.com/upload/2023/04/12/16813149663822_image3.png)](https://user.oc-static.com/upload/2023/04/12/16813149663822_image3.png)

Notez que  `#`  est présent devant l’id, comme on l’écrirait en CSS, alors que ce  `#`  n’était pas nécessaire avec getElementById.

### Récupérez plusieurs éléments avec QuerySelectorAll

Ici, le principe est le même que pour **tous les éléments dans une liste de type** **_NodeList_** (ou liste de nœuds, en français).

Modifions à nouveau notre body :

```
<body>
    <div class="zoneChoix">
        <input type="radio" name="optionSource" id="mots" value="1" checked>
        <label for="mots">Mots</label>
        <input type="radio" name="optionSource" id="phrases" value="2">
        <label for="phrases">Phrases</label>
    </div>
    <div class="zoneProposition">
        Entrez le mot : <span>Cachalot</span>
    </div>
</body>
```

Dans ce code, j’ai ajouté une nouvelle _div_ avec la classe _zoneChoix_. Cette _div_ contient deux inputs de type radio.

Pour récupérer tous les inputs de type radio d’un seul coup, je peux donc écrire :

```
let listeInputRadio = document.querySelectorAll(".zoneChoix input");
console.log(listeInputRadio);
```

Notez que j’ai écrit _.zoneChoix_ et pas #, car ici, j’ai mis une classe à ma _div_ et pas un _id_.

Et voici le résultat : nous obtenons une _NodeList_.

[![Sous l'onglet Console, la NodeList s'affiche à droite d'un petit triangle.](https://user.oc-static.com/upload/2023/04/12/16813151329823_image13.png)](https://user.oc-static.com/upload/2023/04/12/16813151329823_image13.png)

Nous voyons bien ici notre _NodeList_. Pour reprendre l’image de l’arbre DOM, JavaScript a sélectionné dans cet arbre les nœuds qui correspondent à notre sélecteur CSS.

Nous allons devoir parcourir les différents éléments de cette liste un par un pour y accéder. Nous utiliserons donc une boucle :

```
for (let i = 0; i < listeInputRadio.length; i++) {
    console.log(listeInputRadio[i]);
}
```

Et voilà le résultat, nous retrouvons bien le détail de tous nos éléments :

[![Capture d'écran affichant deux lignes qui détaillent  les éléments.](https://user.oc-static.com/upload/2023/04/12/16813152092052_image22.png)](https://user.oc-static.com/upload/2023/04/12/16813152092052_image22.png)

Résultat de la boucle qui parcourt les éléments d’une NodeListe

# À vous de jouer !

Dans cet exercice, je vous propose de récupérer plusieurs éléments dont nous aurons besoin dans le chapitre suivant, lorsque nous procéderons à la modification de la page.

Comme j’aime vous faciliter la vie, j’ai modifié légèrement le projet et réalisé la partie HTML/CSS pour cet exercice. [Vous la trouverez ici.](https://github.com/OpenClassrooms-Student-Center/7696886-javascript/tree/P3-C1---R%C3%A9cup%C3%A9rez-un-%C3%A9l%C3%A9ment---Base)

Dans le fichier main.js :

- Sélectionnez avec la méthode getElementById : 
    - l’input dans lequel le joueur va écrire son texte ; 
    - le bouton de validation.

- Sélectionnez avec la méthode querySelector : 
    - l’endroit où le mot proposé sera affiché ;
    - l’endroit où le score sera affiché. 

- Sélectionnez avec la méthode querySelectorAll : 
    - les boutons radio de choix. 

N’oubliez pas de vérifier que la sélection est correcte à chaque fois, en utilisant un console.log !

## Corrigé

Vous pouvez vérifier votre travail en consultant [le corrigé](https://github.com/OpenClassrooms-Student-Center/7696886-javascript/tree/P3-C1---R%C3%A9cup%C3%A9rez-un-%C3%A9l%C3%A9ment---Correction-de-l'exercice).

# En résumé

- Une page web est constituée de balises HTML, et repose sur une structure que l’on appelle DOM. Cette structure permet de relier les balises entre elles.
- Pour récupérer un élément du DOM :
    - utilisez _defer_ dans l’inclusion de vos fichiers JS pour retarder leur prise en compte, afin que la variable _document_ ait le temps d’être créée ; 
    - partez du point d’entrée du DOM : la variable _document_ ;
    - utilisez les méthodes adaptées : getElementById, querySelector ou querySelectorAll.

_Bravo, vous avez franchi la première étape pour modifier le contenu de votre page HTML. Vous savez désormais récupérer des HMLTElements pour les manipuler depuis votre code ! Dans le prochain chapitre, nous allons modifier la page en ajoutant des éléments, ou en modifiant les classes CSS !_