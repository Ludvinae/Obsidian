
Notre projet avance ! Nous pouvons maintenant proposer plusieurs mots ou phrases Ã  lâ€™utilisateur, compter son score et lâ€™afficher.Â ğŸš€

Pour lâ€™instant notre code est encore relativement petit, mais il va grandir au fur et Ã  mesure du dÃ©veloppement. Il est donc trÃ¨s important de **lâ€™organiser pour quâ€™il reste lisible et fonctionnel**. Câ€™est dâ€™autant plus important que, en tant que dÃ©veloppeur, vous devrez frÃ©quemment dupliquer du code. Voyons ensemble comment Ã©viter cette rÃ©pÃ©tition et rÃ©aliser cela efficacement, grÃ¢ce aux fonctionsÂ !Â ğŸ˜ƒ

# DÃ©couvrez les fonctions

Une **fonction** est un bloc de code auquel on attribue un nom. Appeler cette fonction permet dâ€™exÃ©cuter le code quâ€™elle contient. On parle donc de fonction, car il sâ€™agit dâ€™un bloc de code qui a un rÃ´le spÃ©cifique au sein de votre fichier JavaScript. Une fonction peut ainsiÂ :Â 

- **contenir des informations**, quâ€™on appelle **paramÃ¨tres**Â ;
- retourner un **rÃ©sultat** ;
- effectuer une **action**.Â 

En fait, vous utilisez dÃ©jÃ  des fonctions depuis le dÃ©but de ce cours, sans mÃªme le savoirÂ ! Par exemple, quand vous Ã©crivezÂ :

```
motUtilisateur = prompt('Entrez un mot')
```

_Prompt_ est une fonction :Â 

- elle prend en **paramÃ¨tre** le message Ã  afficher (ici, â€œEntrez un motâ€)Â ;
- elle retourne un **rÃ©sultat** : le mot tapÃ© par lâ€™utilisateur.Â 

Dans lâ€™exemple ci-dessus, le retour de la fonction _prompt_ est copiÃ© dans _motUtilisateur_.Â 

# RÃ©digez une fonction en JavaScript

Dans le cadre de notre application, nous souhaitons Ã©crire une fonction qui va **gÃ©nÃ©rer une phrase pour donner le score** final Ã  l'utilisateur. Cette fonction prendra donc en paramÃ¨tre deux informationsÂ :Â 

- le score ;
- le nombre de questions.

Elle retournera une phrase contenant ces informations.

Cela donne donc :

```
function retournerMessageScore(score, nombreQuestions) {
    let message = 'Votre score est de ' + score + ' sur ' + nombreQuestions
    return message
}
```

Revenons en dÃ©tail sur ce morceau de codeÂ :

- le mot-clÃ© **_function_** (â€œfonctionâ€, en anglais) est suivi du nom â€œ_retournerMessageScore_â€. Ce mot est ici **obligatoire pour** **dÃ©finir** la fonction, mais il nâ€™est ensuite plus nÃ©cessaire lorsquâ€™on lâ€™utiliseÂ ;
- par consÃ©quent, la fonction â€œ_retournerMessageScore_â€ est crÃ©Ã©eÂ ;
- **entre parenthÃ¨ses** sont indiquÃ©s les paramÃ¨tres envoyÃ©s Ã  cette fonction : â€œ_score_â€ et â€œ_nombreQuestions_â€Â ;
- **entre accolades** est indiquÃ© le bloc de code qui sera exÃ©cutÃ© quand la fonction sera appelÃ©e (_let messageâ€¦_ et _return_)Â ;
- dans ce bloc de code, nous dÃ©clarons **une variable** _**message**_ dans laquelle nous crÃ©ons notre messageÂ ;
- le code est finalisÃ© avec le nouveau mot-clÃ© _**return**_. Ce mot signifie que la fonction va retourner le contenu de _message_.Â Â 

Si vous ajoutez ce code dans votre projet et que vous le testez, il ne provoquera aucun changement pour le moment. Ces instructions dÃ©finissent notre fonctionâ€¦ Mais pour quâ€™elle produise son effet, nous devons **lâ€™appeler**.

Par exemple :

```
let nouveauMessage = retournerMessageScore(5, 10)
console.log(nouveauMessage)
```

Gardez Ã©galement en tÃªte que lâ€™**ordre des paramÃ¨tres est trÃ¨s important**Â ! La fonction a un premier paramÃ¨tre nommÃ© â€œ_score_â€ et un second paramÃ¨tre nommÃ© â€œ_nombreQuestions_â€Â :Â 

- si on appelle la fonction avec 5 et 10, 5 Ã©tant le premier paramÃ¨tre, il ira donc dans la variable â€œ_score_â€Â ;
- le 10 Ã©tant positionnÃ© en second, il ira dans la variable â€œ_nombreQuestions_â€, positionnÃ©e en second aussi.Â 

[![Nom de la fonction, Liste des paramÃ¨tres, corps de la fonction, liste des arguments, appel de la fonction, mots-clÃ©s returns et function.](https://user.oc-static.com/upload/2024/04/22/17137968473355_17013406089429_FR_%20Apprenez-a-programmer-avec-JavaScript_Static-Fixed.png)](https://user.oc-static.com/upload/2024/04/22/17137968473355_17013406089429_FR_%20Apprenez-a-programmer-avec-JavaScript_Static-Fixed.png)

Je vous propose de revoir cette opÃ©ration dans la vidÃ©o ci-dessousÂ :

# Codez proprement

Vous vous rendrez compte trÃ¨s rapidement que les fonctions sont un Ã©lÃ©ment majeur de votre code. Il est donc trÃ¨s important de **respecter quelques bonnes pratiques** pour prÃ©venir tout problÃ¨me. Voici quelques conseils.

## DÃ©finissez une tÃ¢che spÃ©cifique pour chaque fonction

Dans lâ€™idÃ©al, on attribue une seule tÃ¢che Ã  une fonctionÂ : afficher, calculer, lancer une opÃ©ration, initialiserâ€¦ Si une fonction sâ€™occupe de tout gÃ©rer Ã  la fois, elle comportera beaucoup de lignes, difficiles Ã  comprendre, Ã  modifier et Ã  tester.

## Ã‰crivez des fonctions courtes

Dans l'idÃ©al, vos fonctions ne doivent pas dÃ©passer 30Â lignes. Si le but de la fonction est clair, un code court est gÃ©nÃ©ralement suffisant pour lâ€™atteindre.

Si la fonction prend trop dâ€™ampleur, câ€™est peut-Ãªtre quâ€™elle est mal conÃ§ue, quâ€™elle fait trop de choses, ou quâ€™il faudrait la dÃ©couper en plusieurs sous-fonctions.

### Nommez clairement vos fonctions

Comme pour les variables, le nom dâ€™une fonction devrait Ãªtre suffisamment clair pour permettre dâ€™en deviner le contenu sans lire le code quâ€™elle contient.

Vous pouvez par exemple utiliser un verbe pour nommer vos fonctions. Si une fonction sâ€™appelle _resultat_, que fait-elleÂ ? Elle calcule le rÃ©sultatÂ ? Elle lâ€™afficheÂ ? Elle le rÃ©initialiseÂ ? En utilisant des noms tels que _afficherResultat_, _calculerResultat_, _reinitialiserResultat_â€¦ lÃ , plus aucune ambiguÃ¯tÃ©Â !Â ğŸ˜ƒ

### Nommez clairement vos paramÃ¨tres

Les paramÃ¨tres doivent Ã©galement Ãªtre le plus explicites possibleÂ :

```
lancerJeu(a) {
    // code
}
```

Que dois-je envoyer Ã  ma fonction pour remplir le paramÃ¨tre _a_Â ? Est-ce quâ€™il reprÃ©sente le nom du joueurÂ ? La liste des mots quâ€™il doit taperÂ ? Autre choseÂ ?Â 

Ici, est donc prÃ©fÃ©rable dâ€™Ã©crire :

```
lancerJeu(listeMots) {
    // code
}
```

Rien quâ€™avec le nom, nous savons maintenant que le paramÃ¨tre contient en rÃ©alitÃ© un tableau avec une liste de mots. Nâ€™oubliez pas non plus quâ€™en cas d'ambiguÃ¯tÃ©, vous pouvez toujours insÃ©rer un commentaire pour ajouter une prÃ©cisionÂ !

# Organisez votre code en plusieurs fichiers

DÃ©couper votre code en plusieurs fonctions permet de mieux organiser vos idÃ©es et facilite les modifications, mais ce nâ€™est pas suffisantâ€¦

Si votre projet continue de grandir, regrouper toutes vos fonctions au mÃªme endroit risque de rapidement causer des problÃ¨mes de lisibilitÃ© et de navigation. Câ€™est encore plus vrai si vous Ãªtes plusieurs Ã  travailler sur le mÃªme projetÂ !

Souvenez-vous, quand nous avons crÃ©Ã© notre fichier index.HTMLÂ dans le chapitre "ApprÃ©hendez la logique de programmation", nous avons Ã©critÂ :

```
<script src="script.js"></script>
```

â€¦ afin dâ€™inclure notre fichier script.

Imaginez maintenant que nous voulions crÃ©er un fichier de configuration qui contiendrait nos deux tableaux _listeMots_ et _listePhrases_. Cela nous permettrait de faire Ã©voluer ces tableaux sans risquer de modifier par erreur la logique du codeÂ !Â ğŸ˜ƒ

Pour y parvenir, nous pouvons inclure ce nouveau fichier en insÃ©rant une nouvelle ligne dans le fichier HTML pour prÃ©ciser le chemin du nouveau fichierÂ :

```
<script src="config.js"></script>
<script src="script.js"></script>
```

Dans cet exemple, jâ€™ai mis le fichier config.js avant script.js, car les variables que je vais dÃ©finir dans le fichier config.js seront utilisÃ©es par script.js. ***Elles doivent donc Ãªtre dÃ©finies en premier.***

Ensuite, nous devons dÃ©finir le contenu du fichier. Pour cela, nous allons supprimer les deux _const listeMots_ et _listesPhrases_ de script.js, et les copierÂ  dans config.js.

```
// Liste des mots utilisÃ©s pour le jeu
const listeMots = ['Bonjour', 'Salut', 'Coucou']
const listePhrases = ['Bonjour, comment allez-vous ?', 'Salut, Ã§a va ?', 'Coucou, Ã§a va ?']
```

N'hÃ©sitez pas Ã  ajouter des commentaires pour donner des prÃ©cisions dans votre code. Mettre un commentaire inutile nâ€™est pas trÃ¨s grave. En revanche, ne pas avoir un commentaire utile peut parfois faire perdre beaucoup de temps.

# MaÃ®trisez la portÃ©e des variables

Nous avons commencÃ© Ã  apprendre le JavaScript en dÃ©clarant des variables. Maintenant que vous manipulez des fonctions et des blocs de code, vous devez maÃ®triser une notion importanteÂ : la **portÃ©e des variables**. Pas de panique, je vous expliqueÂ !Â ğŸ˜‰

Les variables ont une **portÃ©e**, qui est dÃ©finie par lâ€™endroit oÃ¹ cette variable est dÃ©clarÃ©e. Ainsi, on distingue deux types de variablesÂ :Â Â 

- **les variables globales** : visibles et utilisables dans lâ€™ensemble du codeÂ ;
- **les variables locales** : qui ne peuvent Ãªtre utilisÃ©es quâ€™au sein du bloc de code dans lequel elles sont dÃ©finies.

*Ouh lÃ  lÃ  lÃ â€¦Â  Aurais-tu un exemple pour rendre les choses plus clairesÂ ?Â ğŸ˜±*

Bien sÃ»r ! Prenons lâ€™exemple ci-dessousÂ :

```
let monNombre = 1
// monNombre est une variable globale, car elle est dÃ©clarÃ©e en dehors dâ€™un bloc de code
function afficheUnNombre() {
    let monNombreLocal = 2
   // monNombreLocal est une variable locale, car dÃ©clarÃ©e uniquement au sein dâ€™une fonction
    console.log("IntÃ©rieur de la fonction : ")
    console.log(monNombre) // monNombre est accessible
    console.log(monNombreLocal) // monNombreLocal est accessible
}
afficheUnNombre()
console.log("ExtÃ©rieur de la fonction : ")
console.log(monNombre) // monNombre est accessible
console.log(monNombreLocal) // monNombreLocal nâ€™est pas accesssible
```

Si vous copiez-collez ce code dans votre Ã©diteur de code, vous constaterez plusieurs chosesÂ :

- les chiffres 1 et 2 apparaissent en premierÂ : ils sont affichÃ©s dans la fonction _afficheUnNombre_Â ;
- le dernier _console.log_ renvoie une erreur, due au fait que la variable _monNombreLocal_ est dÃ©finie au sein du bloc de code de la fonction _afficheUnNombre_.

Comme il sâ€™agit dâ€™une variable locale, elle nâ€™est pas accessible dans lâ€™ensemble du code. Elle est donc inconnue lorsquâ€™on tente de lâ€™afficher hors de la fonction qui la dÃ©clare.

Ã€ mesure que votre code sâ€™agrandit, les variables sâ€™accumulent. Certaines peuvent dÃ©signer le mÃªme Ã©lÃ©ment, avoir le mÃªme nomâ€¦ et provoquer des rÃ©sultats inattendusÂ ğŸ˜±. En restreignant une variable Ã  un bloc de code, vous lâ€™empÃªchez d'interfÃ©rer avec une autre variable globale. Cela vous Ã©vitera de nombreux bugs particuliÃ¨rement difficiles Ã  trouverÂ !

# Ã€ vous de jouer !

## Ã‰tape 1 : dÃ©coupez votre code en fonctions

Notre but est maintenant dâ€™amÃ©liorer lâ€™organisation et la lisibilitÃ© de [notre code](https://github.com/OpenClassrooms-Student-Center/7696886-javascript/tree/P2-C3---Les-boucles). Je vous propose donc de crÃ©er les fonctions suivantesÂ :Â 

- _afficherResultat_ : cette fonction prend en paramÃ¨tre le rÃ©sultat et le nombre total de mots proposÃ©s, et affiche le rÃ©sultat du joueurÂ ;Â 
- _choisirPhrasesOuMots_ : cette fonction demande Ã  lâ€™utilisateur sâ€™il veut jouer avec des phrases ou des mots.Â 

Tant que lâ€™utilisateur nâ€™a pas rÃ©pondu â€œphrasesâ€ ou â€œmotsâ€, la question lui est posÃ©e en boucle. La fonction ne prend aucun paramÃ¨tre, mais retourne ce que lâ€™utilisateur a rÃ©pondu.

- _lancerBoucleDeJeu_ : cette fonction contient la boucle principale de jeu, c'est-Ã -dire la boucle _for_ qui propose les mots/phrases au joueur, et lui demande de taper ces mots. Elle prend en paramÃ¨tre le tableau de mots/phrases qui sera proposÃ© au joueur, et retourne le nombre de mots/phrases correctement tapÃ©sÂ ;
- _lancerJeu_ : cette fonction sera la fonction principale, câ€™est elle qui sâ€™occupe de lancer toutes les autres. En dâ€™autres termes, câ€™est elle qui va appeler les fonctions que vous venez dâ€™Ã©crire.Â 

## Ã‰tape 2 : sÃ©parez votre code en plusieurs fichiers

- SÃ©parez votre code en plusieurs fichiers.
- CrÃ©ez un fichier config.js qui contiendra uniquement les deux listes de propositions.
- CrÃ©ez un fichier main.js qui contiendra uniquement lâ€™appel Ã  la fonction principale _lancerJeu_.
- VÃ©rifiez que tout fonctionne encore.
- CrÃ©ez un nouveau rÃ©pertoire appelÃ© â€œscriptsâ€, et placez-y tous vos fichiers.
- VÃ©rifiez Ã  nouveau votre code. ğŸ˜ƒ

Pour rÃ©ussir cette Ã©tape, pensez bien Ã  mettre Ã  jour le fichier HTMLÂ !

## CorrigÃ©

Vous pouvez vÃ©rifier votre travail en consultant [le corrigÃ©](https://github.com/OpenClassrooms-Student-Center/7696886-javascript/tree/P2-C4---Les-fonctions).

# En rÃ©sumÃ©

- Une fonction est un morceau de code qui accomplit une tÃ¢che spÃ©cifique. Lâ€™utilisation de fonctions permet dâ€™organiser son code en blocs fonctionnels.
- Pour crÃ©er une fonction en JavaScript, on utilise le mot-clÃ© _function_ et on lui attribue un nom.
- On peut appeler une fonction en utilisant son nom, suivi de parenthÃ¨ses Â `()`Â  . Si la fonction comporte des paramÃ¨tres, ceux-ci sont ajoutÃ©s entre les parenthÃ¨ses.Â 
- Vous pouvez dÃ©finir une valeur de retour que la fonction renvoie aprÃ¨s son exÃ©cution. Cette valeur retournÃ©e par la fonction pourra alors Ãªtre utilisÃ©e dans la suite du code.Â 
- SÃ©parer son code en plusieurs fonctions et en plusieurs fichiers vous permet de mieux dÃ©couper votre code, et donc de le rendre plus simple Ã  comprendre.Â Â 
- Une variable dÃ©clarÃ©e dans un bloc de code nâ€™est accessible que dans ce bloc de code.

_Et voilÃ , vous avez Ã©crit votre premier fichier JavaScript, tout en dÃ©couvrant des bonnes pratiques de code indispensables pour faire de vous un dÃ©veloppeur JavaScript professionnelÂ !Â ğŸ¥³ Vous pouvez Ãªtre fier de vous et vous prÃ©parer Ã  la prochaine Ã©tapeÂ : faire interagir JavaScript avec votre page webÂ ! Mais avant, je vous propose de tester ce que vous avez appris, grÃ¢ce au quiz_.