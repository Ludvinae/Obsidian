
Nous savons dÃ©sormais comment rÃ©cupÃ©rer un Ã©lÃ©ment HTML, le modifier et en crÃ©er de nouveaux. Dans ce chapitre, nous apporterons une nouvelle dimension Ã  notre page grÃ¢ce Ã  la **programmation Ã©vÃ©nementielle**. ConcrÃ¨tement, nous allons dÃ©couvrir comment **rÃ©agir Ã  des Ã©vÃ©nements** comme le clic ou lâ€™utilisation du clavier, pour rendre notre projet interactifÂ ! Câ€™est partiÂ ! Â ğŸš€

# DÃ©couvrez la programmation Ã©vÃ©nementielle

Jusquâ€™Ã  prÃ©sent, notre code sâ€™est toujours exÃ©cutÃ© de maniÃ¨re **sÃ©quentielle**Â : dâ€™abord la premiÃ¨re instruction, puis la seconde, et ainsi de suite jusquâ€™Ã  ce que toutes les instructions aient Ã©tÃ© exÃ©cutÃ©es. Dans ce chapitre, nous allons aborder une nouvelle maniÃ¨re dâ€™envisager la programmation, avec la **programmation Ã©vÃ©nementielle**.

Un **Ã©vÃ©nement** correspond Ã  une action spÃ©cifique, comme par exemple le clic sur un bouton, ou la frappe dâ€™un clavier. Ainsi, la programmation Ã©vÃ©nementielle consiste Ã  **rÃ©agir Ã  ces Ã©vÃ©nements et exÃ©cuter du code au moment oÃ¹ ces Ã©vÃ©nements se produisent**.

Pour implÃ©menter cela, nous devons dâ€™abord dire Ã  JavaScript de les **Ã©couter grÃ¢ce Ã  un eventListener**, littÃ©ralement un â€œÃ©couteur dâ€™Ã©vÃ¨nementâ€, en franÃ§ais. Puis, nous devons **lier lâ€™Ã©vÃ©nement Ã  un bloc de code**. Câ€™est partiÂ !Â ğŸš€

# Ã‰coutez un Ã©vÃ©nement avec addEventListener

_AddEventListener_ est une mÃ©thode fournie par JavaScript, qui peut Ãªtre appelÃ©e directement depuis les Ã©lÃ©ments HTML. Cette mÃ©thode prend deux paramÃ¨tresÂ :Â 

- le nom de lâ€™Ã©vÃ©nement, comme _click_, par exempleÂ ;
- une fonction.Â 

La fonction peut sâ€™Ã©crire de deux maniÃ¨res diffÃ©rentes que nous allons voirÂ :

- les fonctions classiques avec le mot-clÃ© _function_Â ;
- les fonctions flÃ©chÃ©es.Â 

## Utilisez addEventListener avec le mot-clÃ© function

> Prenons un exemple trÃ¨s simple pour illustrer ceci. CrÃ©ons un bouton dans un fichier HTMLÂ :

```
<button id="monBouton">Cliquez-moi !</button>
```

Dans le fichier JavaScript, nous allons rÃ©cupÃ©rer ce bouton et ajouter un Ã©couteurÂ :

```
let monBouton = document.getElementById("monBouton");
    monBouton.addEventListener("click", function () {
        console.log("Vous avez cliquÃ© sur le bouton")
    });
```

Dâ€™abord nous rÃ©cupÃ©rons _monBouton_, jusquâ€™ici, pas de souci. Ensuite, nous dÃ©finissons une fonction avec le mot-clÃ© _function_.

*Heuuâ€¦. Mais la fonction nâ€™a pas de nom ? Câ€™est normalâ€¦Â ?*

Eh oui ! Cette fonction nâ€™a pas de nom, câ€™est ce quâ€™on appelle une **fonction anonyme**. Elle est crÃ©Ã©e au moment oÃ¹ nous faisons notre addEventListener.

Si nous exÃ©cutons ce code, le console.log ne sâ€™affichera pas, car nous avons simplement **ajoutÃ© un Ã©couteur dâ€™Ã©vÃ©nement**. Nous avons dit Ã  ce dernierÂ : â€œLorsque lâ€™Ã©vÃ©nement _click_ se produit sur _monBouton,_ alors tu vas exÃ©cuter la fonction que je te donneâ€. Par consÃ©quent, tant quâ€™on ne clique pas sur le bouton, il ne se passe rien. En revanche, le console.log apparaÃ®tra Ã  lâ€™instant oÃ¹ on cliquera dessus.

Ainsi, gardez bien en tÃªte que, une fois que lâ€™addEventListener est exÃ©cutÃ©, la fonction passÃ©e en paramÃ¨tre ne se lance pas immÃ©diatement. Cette derniÃ¨re sera lancÃ©eÂ :

- au moment oÃ¹ l'Ã©vÃ©nement quâ€™on Ã©coute (ici, un _click_ sur _monBouton_) se produitÂ ;
- autant de fois que lâ€™Ã©vÃ©nement se produit (si on clique dix fois, nous verrons dix fois le message).

## Utilisez addEventListener avec une fonction flÃ©chÃ©e

Dans lâ€™exemple prÃ©cÃ©dent, pour crÃ©er une fonction nous avons utilisÃ© le mot-clÃ© **function**. Cependant, pour corriger certains soucis notamment liÃ©s Ã  la manipulation des objets et Ã  la performance, JavaScript a introduit une autre notationÂ : **les fonctions flÃ©chÃ©es**.

> Voyons un exemple dâ€™addEventListener oÃ¹ le second argument, qui est la fonction qui sera exÃ©cutÃ©e lorsque lâ€™Ã©vÃ©nement se produit, est Ã©crit avec une fonction flÃ©chÃ©eÂ :

```
monBouton.addEventListener("click", () => {
    console.log("Vous avez cliquÃ© sur le bouton")
});
```

Dans le code ci-dessus :

- le mot _function_ est remplacÃ© par des parenthÃ¨ses videsÂ ;Â 
- une flÃ¨che apparaÃ®t entre les parenthÃ¨ses et les accolades (dâ€™oÃ¹ le nom de _fonction flÃ©chÃ©e_Â !)

En dÃ©pit de ces modifications, le fonctionnement reste le mÃªme. La fonction flÃ©chÃ©e sera appelÃ©e Ã  chaque fois que lâ€™utilisateur va cliquer sur _monBouton_.

Les deux notations, fonction flÃ©chÃ©e et _function_, sont trÃ¨s utilisÃ©es. Cependant, pour la suite du cours, je vais privilÃ©gier la notation avec les fonctions flÃ©chÃ©es.Â 

# Pour aller plus loin : rÃ©cupÃ©rez les informations sur un Ã©vÃ©nement avec la variable â€œeventâ€

Il arrive rÃ©guliÃ¨rement que lâ€™on souhaite avoir des informations sur lâ€™Ã©vÃ©nement qui vient de se dÃ©rouler. Par exempleÂ :

- Sur quel Ã©lÃ©ment lâ€™utilisateur a-t-il cliquÃ©Â ?
- Quelles Ã©taient les coordonnÃ©es de la sourisÂ ?
- Sur quelle touche du clavier lâ€™utilisateur a-t-il appuyÃ©Â ?

> Un exemple classique est la gestion du clavier. Lorsque lâ€™on appuie sur une touche, lâ€™Ã©vÃ©nement appelÃ© _keydown_ (anciennementÂ _keypress)_Â se dÃ©clenche. Nous pourrions dâ€™ailleurs lâ€™utiliser dans notre application, par exemple, pour valider un mot lorsque lâ€™on appuie sur la touche _EntrÃ©e_.

Nous pouvons Ã©couter cet Ã©vÃ©nement grÃ¢ce Ã  addEventListener, mais comment savoir quelle touche a Ã©tÃ© pressÃ©eÂ ?

```
document.addEventListener('keydown', (event) => {
    console.log(event.key);
});
```

Entre les parenthÃ¨ses est apparue une nouvelle variable appelÃ©e _event_. Cette variable est fournie directement par JavaScript. Câ€™est un objet qui contient toutes les informations liÃ©es Ã  lâ€™Ã©vÃ©nement. Ici, ce code affiche dans la console toutes les touches sur lesquelles nous pressons.

Nâ€™hÃ©sitez pas Ã  faire un _console.log_ de _event_ pour explorer un peu cette variable. JavaScript propose beaucoup dâ€™informations pour parer Ã  toutes les situations. Certaines dâ€™entre elles sont particuliÃ¨rement intÃ©ressantesÂ :Â 

- event.target : renvoie lâ€™Ã©lÃ©ment HTML qui a dÃ©clenchÃ© lâ€™Ã©vÃ©nementÂ ;
- event.key : la touche appuyÃ©e quand lâ€™Ã©vÃ©nement Ã©coutÃ© est liÃ© au clavierÂ ;
- event.clientX et event.clientY : les coordonnÃ©es de la souris quand lâ€™Ã©vÃ©nement Ã©coutÃ© est liÃ© Ã  la souris.

# Ã€ vous de jouer !

Dans cet exercice, je vous propose de revenir sur plusieurs notions abordÃ©es tout au long de cette troisiÃ¨me partie du cours, en modifiant notre projet. Pour le rÃ©aliser, je vous conseille de partir du [rÃ©sultat que nous avons obtenu Ã  lâ€™issue de lâ€™exercice prÃ©cÃ©dent](https://github.com/OpenClassrooms-Student-Center/7696886-javascript/tree/P3-C2---Manipulez-un-%C3%A9l%C3%A9ment---Correction-de-l%27exercice).

## Ã‰tape 1 : nettoyez le projet

Votre premiÃ¨re Ã©tape consiste Ã  supprimer les Ã©lÃ©ments qui seront modifiÃ©s dans notre projetÂ :

- mettez en commentaire toutes les mÃ©thodes qui utilisent _prompt_Â ;
- mettez Ã  jour la fonction _lancerJeu_ pour quâ€™elle ne fasse plus appel Ã  ces fonctions.Â 

Vous devez Ã©galement dÃ©sactiver temporairement le choix entre la liste des phrases et la liste des mots, de maniÃ¨re Ã  utiliser systÃ©matiquement la liste des mots Â :

- mettez Ã  jour la fonction _lancerJeu_, et commentez ce qui concerne la variable _listePhrases_.Â 

## Ã‰tape 2 : gÃ©rez le clic sur le bouton â€œValiderâ€

Ã€ ce stade, le projet nâ€™est plus fonctionnel, il nâ€™est plus possible de jouer. Vous devez donc reconstruire ce que vous avez commentÃ© Ã  la premiÃ¨re Ã©tape, en interagissant directement avec la page HTML.

Votre premiÃ¨re Ã©tape est de pouvoir rÃ©agir au clic sur le bouton â€œEnvoyerâ€Â :

- Dans la fonction lancerJeu, rÃ©cupÃ©rez le bouton de validation et Ã©coutez lâ€™Ã©vÃ©nement _click_ en utilisant la mÃ©thode _addEventListener._
- Testez que cela fonctionne avec un console.log(â€œjâ€™ai cliquÃ©Â !â€).
- RÃ©cupÃ©rez la balise _inputEcriture_ et placez-la dans une variable.Â 
- Dans lâ€™addEventListener, faites un console.log avec la valeur contenue dans cette balise.

Pour accÃ©der Ã  la valeur contenue dans la balise _inputEcriture_, utilisez la propriÃ©tÃ© _value_.Â 

- Testez en Ã©crivant quelque chose dans le champ, et en vÃ©rifiant que la valeur apparaÃ®t bien lorsque vous cliquez sur _Envoyer_.Â 

## Ã‰tape 3 : affichez les mots que lâ€™utilisateur doit recopier

Ã€ ce stade, vous savez comment rÃ©cupÃ©rer le mot que lâ€™utilisateur a Ã©crit, mais vous nâ€™affichez pas encore le mot quâ€™il devra recopier. Pour rÃ©aliser cette mise Ã  jour du code HTMLÂ :

- Ã  lâ€™extÃ©rieur du addEventListener, crÃ©ez une variable _i_ qui servira de compteur. Dans lâ€™addEventListener, ajoutez 1 Ã  i Ã  chaque fois que lâ€™utilisateur clique sur le bouton _Envoyer_Â ;Â 
- ajoutez un console.log qui va afficher le mot numÃ©ro _i_ du tableau _listeMots_Â ;
- crÃ©ez une fonction _afficherProposition_, qui va prendre en paramÃ¨tre le mot Ã  afficher, et afficher ce mot dans la div _zoneProposition_Â ;Â Â 
- utilisez cette fonction pour afficher les mots Ã  proposer.Â 

AprÃ¨s ces opÃ©rations, vous devriez voir apparaÃ®tre les mots un par un aprÃ¨s avoir rÃ©alisÃ© ces opÃ©rations. Cependant, vous remarquerez peut-Ãªtre que le mot â€œundefinedâ€ sâ€™affiche lorsquâ€™il nâ€™y a plus de mots disponibles dans le tableau. Pour rÃ©gler ce problÃ¨meÂ :

- ajoutez un test dans lâ€™_addEventListener_. Si le mot numÃ©ro _i_ du tableau vaut undefined, Ã©crivez le message â€œLe jeu est finiâ€ Ã  la place du mot, et dÃ©sactivez le bouton de validation. Pour dÃ©sactiver ce bouton, mettez la propriÃ©tÃ© _disabled_ de ce bouton Ã  _true_Â ;Â 
- Ã  chaque fois que lâ€™utilisateur clique sur _Valider_, videz le champ _inputEcriture_.Â 

## Ã‰tape 4 : gÃ©rez le score

Il nous reste une derniÃ¨re Ã©tape : gÃ©rer le score de lâ€™utilisateur.

- Dans lâ€™_addEventListener_, comparez ce quâ€™a Ã©crit lâ€™utilisateur et le mot proposÃ©. Si ces deux mots sont identiques, augmentez le score.Â 
- Dans tous les cas, mettez Ã  jour le score en appelant la fonction de mise Ã  jour du score avec les bons paramÃ¨tres.Â 

### CorrigÃ©

Je vous invite Ã  vÃ©rifier lâ€™intÃ©gralitÃ© du projet en consultant [ce corrigÃ© sur GitHub](https://github.com/OpenClassrooms-Student-Center/7696886-javascript/tree/P3-C4---G%C3%A9rez-les-%C3%A9v%C3%A9nements). Toutes mes fÃ©licitations pour votre travail ! ğŸ¥³

# En rÃ©sumÃ©

- La programmation Ã©vÃ©nementielle consiste Ã  Ã©crire du code qui rÃ©agit Ã  des Ã©vÃ©nements.
- Un Ã©vÃ©nement est un signal envoyÃ© par lâ€™Ã©lÃ©ment HTML lorsque lâ€™utilisateur effectue une action (clic, frappe au clavierâ€¦).
- Pour savoir quand un Ã©vÃ©nement est envoyÃ©, vous devez attacher un Ã©couteur Ã  lâ€™Ã©lÃ©ment HTML.
- Pour gÃ©rer un Ã©vÃ©nement, vous devez lâ€™Ã©couter en utilisant la mÃ©thode _AddEventListener_.
- Vous pouvez rÃ©cupÃ©rer des informations sur un Ã©vÃ©nement en utilisant la variable _event_.

_Vous savez dÃ©sormais comment faire interagir une page web avec JavaScript et la rendre interactive. Que de chemin parcouru depuis vos premiers pas en JavaScriptÂ ! Pour maÃ®triser les bases de ce langage, je vous propose une derniÃ¨re Ã©tape dans la 4eÂ partie de ce coursÂ : crÃ©er un formulaire de saisie sur une page web. Mais avant de dÃ©couvrir comment faire, je vous propose de rÃ©aliser le quiz.Â ğŸ™‚_